var Anet=Anet||{};Anet.Site=Anet.Site||{};Anet.Site.SecretConfigControl=function($scope,$http,shared){$scope.secret={question:''};$scope.questions=Anet.Site.SecretQuestionList;$scope.sharedData=shared.getObject();$scope.sharedData.showQuestion=false;$scope.createQuestionError="";$scope.logo=Anet.Site.Logo;$scope.title=Anet.Site.Title;$scope.savingData=false;if($scope.questions!=null){$scope.sharedData.showQuestion=true;$('body').find(':input, a').each(function(){$(this).attr('tabindex',-1);});$('#createSecretAnswerOuter').find(':input, a').each(function(){$(this).attr('tabindex',1);});}
$scope.createQuestion=function(secret){$scope.savingData=true;secret[$('#pageKey').attr('name')]=$('#pageKey').val();var url=Anet.Site.BoardingController+'CreateSecretQuestionAnswer';var headers={'Content-Type':'application/x-www-form-urlencoded'};var pageKey=$('#pageKey').attr('name');$('#QuestionId').remove();var form=$('Form').eq(0).append($('<input>',{'id':'secretPageKey','name':pageKey,'value':$('#pageKey').val(),'type':'hidden'})).append($('<input>',{'id':'QuestionId','name':'QuestionId','value':secret.question.Key,'type':'hidden'}));$http({url:url,method:"POST",data:form.serialize(),headers:headers}).then(function(response){$('#pageKey').val(response.data.PageKey);if(response.data.hasOwnProperty('Success')===false||response.data.Critical){window.location=Anet.Site.ErrorPage;}else{if(response.data.Success){$('body').find(':input, a').each(function(){$(this).attr('tabindex',-1);});$('#getStartedOuter').find(':input, a').each(function(){$(this).attr('tabindex',1);});$scope.sharedData.showQuestion=false;}else{$scope.savingData=false;$scope.createQuestionError=response.data.Error;}}}).catch(function(response){window.location=Anet.Site.ErrorPage;});}};Anet.Site.HomeControl=function($scope,$http,shared,modalService){$scope.phasedActivation=Anet.Site.PhasedActivation;$scope.phasedActivationWithProcessorAccount=Anet.Site.PhasedActivationWithProcessorAccount;$scope.shared=shared.getObject();$scope.showSplash=Anet.Site.ShowSplash;$scope.liveModeChecked=Anet.Site.OnOffSwitchStatus;$scope.isProcessorInfoCollected=Anet.Site.IsProcessorInfoCollected;$scope.showECheckSignup=Anet.Site.ShowECheckSignup;$scope.isCreditCardProcessorInfoCollected=Anet.Site.IsCreditCardProcessorInfoCollected;$scope.isECheckActivationEnabled=Anet.Site.IsECheckActivationEnabled;$scope.showMobileInSplash=Anet.Site.ShowMobileInSplash;$scope.showInstoreInSplash=Anet.Site.ShowInstoreInSplash;$scope.showOnlineInSplash=true;$scope.isAUApplicable=true;$scope.isAUEnabled=true;$scope.isLiveMode=(Anet.Site.OnOffSwitchStatus=="checked");$scope.isMerchantInLiveMode=false;$scope.isUpdatingTestMode=false;$scope.isAPIUserCreated=Anet.Site.IsAPIUserCreated;$scope.eCheckServiceStatusDescription=Anet.Site.ECheckServiceStatusDescription;$scope.isECheckUnderwriting=$scope.eCheckServiceStatusDescription!="";$scope.isPhasedActivationConfirmed=Anet.Site.IsPhasedActivationConfirmed;$scope.showConnectToMerchantAccount=Anet.Site.ShowProcessorInfo;$scope.pendingProcessorInfoFromUser=Anet.Site.PendingFromGatewayApplication;$scope.pendingProcessorInfoFromApp=Anet.Site.PhasedActivationWithProcessorAccount&&!$scope.isCreditCardProcessorInfoCollected;$scope.pendingProcessorInfo=$scope.pendingProcessorInfoFromUser||$scope.pendingProcessorInfoFromApp;$scope.isOnePlatformMigrated=Anet.Site.IsOnePlatformMigrated;$scope.isSettlementEnabled=Anet.Site.IsSettlementEnabled;if($scope.showSplash&&!$scope.shared.showQuestion){$('body').find(':input, a').each(function(){$(this).attr('tabindex',-1);});$('#getStartedOuter').find(':input, a').each(function(){$(this).attr('tabindex',1);});}
if($scope.isLiveMode){$('#onoffswitch-label').addClass('switchOn');}else{$('#onoffswitch-label').removeClass('switchOn');}
$scope.setTestMode=function(){if(!$scope.isUpdatingTestMode){$scope.isUpdatingTestMode=true;if(!$scope.isMerchantInLiveMode){var headers={'Content-Type':'application/x-www-form-urlencoded'};$('.ajaxPostForm').remove();var mintForm=$('<form>',{'class':'ajaxPostForm'}).append($('<input>',{'name':$('#pageKey').attr('name'),'value':$('#pageKey').val(),'type':'hidden'}));mintForm.appendTo('body');if($('#onoffswitch').prop('disabled')===false&&$('#onoffswitch-label').hasClass('switchOn')===false){$http({url:Anet.Site.BoardingController+"IsMerchantInLiveMode",method:"POST",data:mintForm.serialize(),headers:headers}).then(function(response){if(response.data.hasOwnProperty('Success')===false||response.data.Success===false){window.location=Anet.Site.ErrorPage;}else{$('#pageKey').val(response.data.PageKey);$scope.isMerchantInLiveMode=false;if(response.data.hasOwnProperty('IsLiveMode')===true){$scope.isMerchantInLiveMode=response.data.IsLiveMode;}
if(response.data.hasOwnProperty('IsBillAtLive')===true&&response.data.IsBillAtLive&&!$scope.isMerchantInLiveMode){$scope.isUpdatingTestMode=false;$scope.showLiveModeDialog();}else{$scope.setTestModeLocal();}}}).catch(function(response){window.location=Anet.Site.ErrorPage;});}else{$scope.setTestModeLocal();}}else{$scope.setTestModeLocal();}}}
$scope.showLiveModeDialog=function(){var modalDefaults={backdrop:true,keyboard:true,modalFade:true,windowClass:'custom-modal-dialog',templateUrl:'/UI/View/Modals/MerchantLiveMode.html'};var modalOptions={closeButtonText:'Cancel',actionButtonText:'Activate Account',headerText:'Account Activation',bodyText:'Switching from Test mode to Live mode activates your account and begins the billing process.'};modalService.showModal(modalDefaults,modalOptions).then(function(result){$scope.setTestModeLocal();$scope.isMerchantInLiveMode=true;});}
$scope.setTestModeLocal=function(){var url=Anet.Site.BoardingController;var testMode=false;if($('#onoffswitch').prop('disabled')===true)return;if($('#onoffswitch-label').hasClass('switchOn')===false){$('#onoffswitch-label').addClass('switchOn');url+='SetTestModeOff';$scope.isLiveMode=true;}else{$('#onoffswitch-label').removeClass('switchOn');url+='SetTestModeOn';testMode=true;$scope.isLiveMode=false;}
var headers={'Content-Type':'application/x-www-form-urlencoded'};$('.ajaxPostForm').remove();var mintForm=$('<form>',{'class':'ajaxPostForm'}).append($('<input>',{'name':$('#pageKey').attr('name'),'value':$('#pageKey').val(),'type':'hidden'}));mintForm.appendTo('body');$http({url:url,method:"POST",data:mintForm.serialize(),headers:headers}).then(function(response){if(response.data.hasOwnProperty('Success')===false||response.data.Success===false){window.location=Anet.Site.ErrorPage;}else{$scope.isUpdatingTestMode=false;if(testMode){$('#TestModeBar').show();}else{$('#TestModeBar').hide();}
$('#pageKey').val(response.data.PageKey);$scope.setQtip();}}).catch(function(response){window.location=Anet.Site.ErrorPage;});}
$scope.showSplashOn=function(){$('body').find(':input, a').each(function(){$(this).attr('tabindex',-1);});$('#getStartedOuter').find(':input, a').each(function(){$(this).attr('tabindex',1);});$scope.showSplash=true;}
$scope.hideSplash=function(){$('body').find(':input, a').each(function(){$(this).attr('tabindex',1);});$scope.showSplash=false;}
$scope.turnOffSplash=function(){$scope.hideSplash();var url=Anet.Site.BoardingController+'TurnOffSplash';var headers={'Content-Type':'application/x-www-form-urlencoded'};$('.ajaxPostForm').remove();var mintForm=$('<form>',{'class':'ajaxPostForm'}).append($('<input>',{'name':$('#pageKey').attr('name'),'value':$('#pageKey').val(),'type':'hidden'}));mintForm.appendTo('body');$http({url:url,method:"POST",data:mintForm.serialize(),headers:headers}).then(function(response){$('#pageKey').val(response.data.PageKey);if(response.data.Success){}else{}}).catch(function(response){});}
$scope.setQtip=function(){if($scope.pendingProcessorInfo||(!$scope.isLiveMode&&$scope.isOnePlatformMigrated)){$('#liveModeSwitch').qtip({content:{text:$('#testModeProcessorInfo')},position:{my:'top left',at:'bottom left'},style:{classes:'testMode-tooltip',tip:false},show:{event:'click mouseover'},hide:false,events:{show:function(){var that=$(this);$('.qtip-close-icon').one('click',function(){$(that).qtip('hide');});$('body').one('click',function(){$(that).qtip('hide');});$('#testModeProcessorInfo').on('click',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();});$('#liveModeSwitch').on('click',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();});},hide:function(){$('.qtip-close-icon').off('click');$('body').off('click');$('#testModeProcessorInfo').off('click');}}});}}
$scope.setQtip();};Anet.App.controller('SecretConfigControl',Anet.Site.SecretConfigControl);Anet.App.controller('HomeControl',Anet.Site.HomeControl);$(document).ready(function(){var is_explorer=navigator.userAgent.indexOf('MSIE')>-1;if(is_explorer&&parseFloat(navigator.browserSpecs.version)<8&&Anet.Site&&Anet.Site.PhasedActivation){$('#topNav').closest('table').hide();var notSupported='<div id="notSupported"><div id="notSupportedInner"><div>You are either using an unsupported browser version or you are running IE in compatibility mode.</div>';notSupported+='<div><ul><li>Please use one of the following supported browser and versions:';notSupported+='<div><ul><li>Internet Explorer 8 or above</li><li>Chrome</li><li>Firefox</li><li>Safari</li></ul></div>';notSupported+='</li><li>If you are running IE in compatibility mode, please turn compatibility mode off.</li></ul></div></div>';$('.MainBody').append(notSupported);$('#notSupported').show();}
$('.hoverTip').each(function(){$(this).qtip({content:{text:$(this).next('div')},position:{my:'top left',at:'bottom right',target:$('.hoverTip')},show:{when:'mouseover',delay:0},hide:{when:'inactive',delay:1000},style:{classes:'main-tooltip'}});});$('.clickTip').each(function(){$(this).qtip({content:{text:$(this).next('div')},position:{my:'top left',at:'bottom center'},show:{when:'mouseover',delay:0},hide:{when:'inactive',delay:1000},style:{classes:'main-tooltip small'}});});});